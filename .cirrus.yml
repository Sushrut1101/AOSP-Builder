env:

    MANIFEST: repo init -u https://github.com/LineageOS/android.git -b lineage-20.0
    DEVICE: oscar

    OEM: oneplus

    DT_LINK: https://github.com/Spector0/device_oneplus_oscar.git
    DT_PATH: device/oneplus/oscar
    VT_LINK: https://github.com/OnePlus-sm6375-devices/vendor_oneplus_oscar.git
    VT_PATH: vendor/oneplus/oscar
    KT_LINK: https://github.com/OnePlus-sm6375-devices/android_kernel_oneplus_sm6375.git
    PLATFORM: sm6375
    KT_PATH: kernel/oneplus/holi
    CT_LINK: https://github.com/OnePlus-sm6375-devices/android_device_oneplus-sm6375-common.git
    CT_PATH: device/oneplus/sm6375-common
    O_LINK: https://github.com/OnePlus-sm6375-devices/android_device_oneplus_oscar-kernel.git
    O_PATH: device/oneplus/oscar-kernel
    H_LINK: https://github.com/LineageOS/android_hardware_oneplus.git
    H_PATH: hardware/oneplus
    
    TARGET: bacon

    EXTRA_CMD: export SKIP_ABI_CHECKS=true

    LUNCH_COMBO: aosp_holi-userdebug

    OUTPUT: PixelExperience*.zip

task:

  name: "Setting Up, Syncing, Building and Uploading..."

  timeout_in: 240m  

  container:

      image: ubuntu:20.04

      cpu: 8

      memory: 32G

        

  Build-Env-Setup_script:

       - export DEBIAN_FRONTEND=noninteractive

       - apt update

       - apt install sudo

       - DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends tzdata

       - ln -sf /usr/share/zoneinfo/Asia/Kolkata /etc/localtime

       - apt-get install -y tzdata

       - dpkg-reconfigure --frontend noninteractive tzdata

       - sudo apt update -y && sudo apt install git aria2 curl wget rsync zip unzip lzma cpio ccache clang -y

       - sudo apt install python3 -y

       - sudo ln -sf /usr/bin/python3 /usr/bin/python

       - git config --global user.name "Sushrut1101"

       - git config --global user.email "guptasushrut@gmail.com"

       - git clone https://github.com/akhilnarang/scripts.git ~/scripts

       - cd ~/scripts

       - sudo bash setup/android_build_env.sh

       - cd ~

  

  Storage-Checker_script:

      - df -h

      - lsblk

      - ls -l -a -h

  

  Sync_script:

      - echo "============================"

      - echo "Syncing The Sources..."

      - echo "============================"

      - mkdir -p ~/work

      - cd ~/work

      - repo init -u https://github.com/PixelExperience/manifest -b thirteen

      - repo sync -j31 --force-sync --no-tags --no-clone-bundle

      - git clone $DT_LINK $DT_PATH

      - git clone $VT_LINK $VT_PATH

      - git clone $KT_LINK $KT_PATH
      - git clone $CT_LINK $CT_PATH
      - git clone $O_LINK $O_PATH
      - git clone $H_LINK #H_PATH
      - echo "============================"

      - echo "Syncing Complete!"

      - echo "============================"

  Build_script:

      - echo "============================"

      - echo "Starting the Build..."

      - echo "============================"

      - cd ~/work

      - $EXTRA_CMD

      - export USE_CCACHE=1

      - export CCACHE_EXEC=/usr/bin/ccache

      - ccache -M 50G

      - . build/envsetup.sh

      - lunch "$LUNCH_COMBO"

      - make bacon

     

  Upload_script:

      - echo "============================"

      - echo "Uploading the Build..."

      - echo "============================"

      - cd ~/work

      - cd out/target/product/"$DEVICE"

      - ls -lh

      - pwd

      - chmod 777 *

      - curl --upload-file $(echo $OUTPUT) https://transfer.sh | tee link.txt && echo " "

      - echo " "

      - echo "============================"

      - echo "Build Uploaded!"

      - echo "Please see the link Below-  "

      - echo "----------------------------"

      - cat link.txt && echo " "

      - echo "============================"



